pip install snowflake-connector-python


import snowflake.connector

# Snowflake connection parameters
account = 'your_account'
user = 'your_user'
password = 'your_password'
warehouse = 'your_warehouse'
database = 'your_database'
schema = 'your_schema'
stage_name = 'your_stage'

# Local file path
local_file_path = '/path/to/your/local/file.csv'

# Snowflake connection
conn = snowflake.connector.connect(
    user=user,
    password=password,
    account=account,
    warehouse=warehouse,
    database=database,
    schema=schema
)

# Create a Snowflake cursor
cursor = conn.cursor()

# Copy data from local file to Snowflake internal stage
copy_query = f"COPY INTO @{stage_name} FROM '{local_file_path}' FILE_FORMAT=(TYPE='CSV' FIELD_OPTIONALLY_ENCLOSED_BY='\"')"

cursor.execute(copy_query)

# Close cursor and connection
cursor.close()
conn.close()
